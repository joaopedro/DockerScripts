<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="	http://www.springframework.org/schema/beans  http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
       						http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd">

	<bean id="directoryUtil" class="com.sinfic.ipdms.io.util.DirectoryUtil" />

    <bean id="numeroUnicoHelper" class="com.sinfic.ipdms.domain.business.numerounico.NumeroUnicoHelper" />


	<bean id="fileManagerFactory" class="com.sinfic.ipdms.io.file.FileManagerFactory">
		<constructor-arg ref="defaultFileEngine" />
		<constructor-arg>
			<map key-type="java.lang.Class">
				<entry key="com.sinfic.ipdms.domain.entity.Apresentacao" value-ref="apresentacaoFileManager" />
				<entry key="com.sinfic.ipdms.domain.entity.Modulo" value-ref="moduloFileManager"/>
				<entry key="com.sinfic.ipdms.modules.templates.domain.Template" value-ref="templateFileManager"/>
				<entry key="com.sinfic.ipdms.domain.entity.Relatorio" value-ref="relatorioFileManager"/>
				<entry key="com.sinfic.ipdms.domain.entity.documento.DocumentoAnexadoInstrucao" value-ref="documentoAnexadoInstrucaoFileManager"/>
				<entry key="com.sinfic.ipdms.domain.entity.documento.DocumentoAnexadoTramitacao" value-ref="documentoAnexadoTramitacaoFileManager"/>
				<entry key="com.sinfic.ipdms.domain.entity.documento.DocumentoTemplate" value-ref="documentoTemplateFileManager" />
				<entry key="com.sinfic.ipdms.domain.entity.documento.DocumentoTemplateInstrucao" value-ref="documentoTemplateInstrucaoFileManager" />
				<entry key="com.sinfic.ipdms.domain.entity.documento.DocumentoAssociadoInstrucao" value-ref="documentoAssociadoInstrucaoFileManager" />				
				<entry key="com.sinfic.ipdms.domain.entity.AnexoGuichet" value-ref="anexoGuichetFileManager" />
				<entry key="com.sinfic.ipdms.domain.entity.ColaboradorInfo" value-ref="colaboradorInfoFileManager" />
				<entry key="com.sinfic.ipdms.domain.entity.Variante" value-ref="templateInstrucaoFileManager" />
			</map>
		</constructor-arg>
	</bean>
						
	<!--bean id="exampleSimpleFileEngine" class="com.sinfic.ipdms.io.file.engine.SimpleFileEngine">
		<constructor-arg value="/tmp/somedir" />
		<constructor-arg index="1" value="java:java.io.tmpdir" />
	</bean-->									
						
	<bean id="defaultFileEngine" class="com.sinfic.ipdms.io.file.engine.WebappFileEngine" depends-on="directoryUtil">
		<constructor-arg index="0" value="docs" />
	</bean>

	<bean id="sigFileEngine" class="com.sinfic.ipdms.io.file.engine.WebappFileEngine">
		<constructor-arg index="0" value="docs/SIG_ICONS" />
	</bean>

	<bean id="apresentacaoFileManager" class="com.sinfic.ipdms.io.file.manager.impl.ApresentacaoFileManager">
		<constructor-arg ref="defaultFileEngine" />
	</bean>
		
	<bean id="moduloFileManager" class="com.sinfic.ipdms.io.file.manager.impl.ModuloFileManager">
		<constructor-arg>
			<bean class="com.sinfic.ipdms.io.file.engine.WebappFileEngine">
				<constructor-arg value="docs/moduloicons" />
			</bean>
		</constructor-arg>
	</bean>

	<bean id="templateFileManager" class="com.sinfic.ipdms.io.file.manager.impl.TemplateFileManager">
		<constructor-arg>
			<bean class="com.sinfic.ipdms.io.file.engine.SimpleFileEngine">
				<constructor-arg value="/opt/agora/appData/templates" />
			</bean>
		</constructor-arg>
	</bean>

	<bean id="relatorioFileManager" class="com.sinfic.ipdms.io.file.manager.impl.RelatorioFileManager">
		<constructor-arg>
			<bean class="com.sinfic.ipdms.io.file.engine.SimpleFileEngine">
				<constructor-arg value="/opt/agora/appData/relatorio" />
			</bean>
		</constructor-arg>
	</bean>

	<bean id="colaboradorInfoFileManager" class="com.sinfic.ipdms.io.file.manager.impl.ColaboradorInfoFileManager">
		<constructor-arg>
			<bean class="com.sinfic.ipdms.io.file.engine.SimpleFileEngine">
				<constructor-arg value="/opt/agora/appData/colaboradorsignatures" />
			</bean>
		</constructor-arg>
	</bean>
	
	<bean id="templateInstrucaoFileManager" class="com.sinfic.ipdms.io.file.manager.impl.VarianteFileManager">
		<constructor-arg>
			<bean class="com.sinfic.ipdms.io.file.engine.SimpleFileEngine">
				<constructor-arg value="/opt/agora/appData/templatesinstrucao" />
			</bean>
		</constructor-arg>
	</bean>


	<bean abstract="true" id="abstractDocumentoFileManager" class="com.sinfic.ipdms.io.file.manager.impl.DocumentoFileManager">
		<constructor-arg index="0" ref="defaultFileEngine" />
		<constructor-arg index="1" ref="genericNumeroDocumentoGenerator" />
	</bean>
		
	<bean id="documentoAnexadoTramitacaoFileManager" 
		class="com.sinfic.ipdms.io.file.manager.impl.DocumentoAnexadoTramitacaoFileManager"  
		parent="abstractDocumentoFileManager" />
	
	<bean id="documentoAnexadoInstrucaoFileManager" 
		class="com.sinfic.ipdms.io.file.manager.impl.DocumentoAnexadoInstrucaoFileManager" 
		parent="abstractDocumentoFileManager" />
	
	<bean id="documentoTemplateFileManager" 
		class="com.sinfic.ipdms.io.file.manager.impl.DocumentoTemplateFileManager" 
		parent="abstractDocumentoFileManager">
		<constructor-arg index="1" ref="docTemplateNumeroDocumentoGenerator" />
	</bean>
	
	<bean id="documentoTemplateInstrucaoFileManager" 
		class="com.sinfic.ipdms.io.file.manager.impl.DocumentoTemplateIntrucaoFileManager" 
		parent="abstractDocumentoFileManager" />
		
	<bean id="documentoAssociadoInstrucaoFileManager" 
		class="com.sinfic.ipdms.io.file.manager.impl.DocumentoAssociadoInstrucaoFileManager" 
		parent="abstractDocumentoFileManager" />
	
	<bean id="anexoGuichetFileManager" class="com.sinfic.ipdms.io.file.manager.impl.AnexoGuichetFileManager">
		<constructor-arg>
			<bean class="com.sinfic.ipdms.io.file.engine.SimpleFileEngine">
				<constructor-arg value="/opt/agora/appData/anexoguichet" />
			</bean>
		</constructor-arg>
	</bean>
	
	<bean id="fileUploadProperties" class="com.sinfic.ipdms.io.util.FileUploadPolicyProperties">
		<property name="maxFileSize" value="10" /><!-- Mega -->
		<property name="acceptedContentTypes">
			<list>
				<value>text/plain</value>
				<value>text/xml</value>
				<value>text/html</value>
				<value>text/csv</value>
				<value>application/msword</value>
				<value>application/vnd.ms-excel</value>
				<value>application/vnd.ms-powerpoint</value>
				<value>text/rtf</value>
				<value>application/vnd.oasis.opendocument.text</value>
				<value>application/vnd.oasis.opendocument.spreadsheet</value>
				<value>application/vnd.oasis.opendocument.presentation</value>
				<value>application/vnd.sun.xml.calc</value>
				<value>application/vnd.openxmlformats-officedocument.wordprocessingml.document</value>
				<value>application/vnd.openxmlformats-officedocument.spreadsheetml.sheet</value>
				<value>application/vnd.openxmlformats-officedocument.presentationml.presentation</value>				
				<value>application/pdf</value>
				<value>image/jpeg</value>
				<value>image/gif</value>
				<value>image/bmp</value>
				<value>image/png</value>
				<value>application/x-zip-compressed</value>
				<!-- TIF & TIFF -->
				<value>image/tif</value>
				<value>image/x-tif</value>
				<value>image/tiff</value>
				<value>image/x-tiff</value>
				<value>application/tif</value>
				<value>application/x-tif</value>
				<value>application/tiff</value>
				<value>application/x-tiff</value>
				<!-- /TIF & TIFF -->
                <value>application/x-extension-eml</value>
                <!-- MS Outlook -->
                <value>application/octet-stream</value>
			</list>
		</property>
		<property name="systemExtensions">
			<list>
				<value>ipdmsbundle</value>
				<value>rptdesign</value>
			</list>
		</property>
		<property name="validTypesDescription" value="txt,xml,docx,pdf" />
	</bean>
	
	<bean id="pdfBarCodeService" class="com.sinfic.ipdms.utils.pdf.impl.PDFBarCodeServiceImpl">
		<constructor-arg ref="defaultFileEngine" />
		<constructor-arg>
			<bean class="com.sinfic.ipdms.integration.zxing.QRCodeFactory" />
		</constructor-arg>
		<constructor-arg>
			<bean class="com.sinfic.ipdms.integration.bdo.AddImageToPDFImpl" />
		</constructor-arg>
		<constructor-arg>
			<bean class="com.sinfic.ipdms.integration.icepdf.ReadImageFromPDFImpl" />
		</constructor-arg>
	</bean>
	
	<bean id="registeredExternalFolderService" 
			class="com.sinfic.ipdms.io.services.impl.RegisteredExternalFolderImpl" />
	
	<bean id="fileEnginePostProcessor" 
			class="com.sinfic.ipdms.io.file.business.FileEnginePostProcessor">
		<constructor-arg ref="registeredExternalFolderService" />
	</bean>
	
	<bean id="registeredExternalFolderServiceExporter" class="com.sinfic.ipdms.integration.spring.remoting.HttpInvokerServiceExporter">
		<property name="serviceInterface" value="com.sinfic.ipdms.io.services.RegisteredExternalFoldersService" />
		<property name="service" ref="registeredExternalFolderService" />
	</bean>
	
	<bean name="bundleFileEngine" class="com.sinfic.ipdms.io.file.engine.SimpleFileEngine">
		<constructor-arg value="/tmp/exportbundle" />
	</bean>
		
	<bean id="documentExportBundleService" class="com.sinfic.ipdms.services.document.impl.DocumentsAsBundleImpl">
		<constructor-arg ref="exportBundleRepository" />
		<constructor-arg ref="documentoRepository" />
		<constructor-arg ref="varianteRepository" />
		<constructor-arg ref="bundleFileEngine" />
		<constructor-arg ref="importBundleRepository" />
		<constructor-arg ref="pdfConverter" />
		<constructor-arg ref="dynamicFieldInstanceRepository"/>
	</bean>
	
	
	<bean id="previewDocumento" class="com.sinfic.ipdms.domain.business.documento.impl.PreviewDocumentoImpl">
		<constructor-arg ref="pdfConverter" />
		<constructor-arg ref="previewDocumentFileEngine" />
		<constructor-arg>
			<bean class="com.sinfic.ipdms.integration.pdfrenderer.PDFImagePreviewExtractorImpl">
				<constructor-arg ref="previewDocumentFileEngine" />
				<constructor-arg>
					<util:map key-type="com.sinfic.ipdms.domain.business.pdf.ImageResolution">
						<entry key="HIGH" value="200" />
						<entry key="LOW" value="100" />
					</util:map>
				</constructor-arg>
			</bean>
		</constructor-arg>
		<constructor-arg>
			<list>
				<value>png</value>
				<value>jpg</value>
				<value>gif</value>
			</list>
		</constructor-arg>
	</bean>
	
	<bean id="previewDocumentFileEngine" class="com.sinfic.ipdms.io.file.engine.SimpleFileEngine">
		<constructor-arg value="/tmp/preview/" />
		<constructor-arg index="1" value="/tmp/preview/" />
	</bean>

    <bean id="emailReaderEML" class="com.sinfic.ipdms.integration.jsoup.ReadEmailEML" />

    <bean id="emailReaderMSG" class="com.sinfic.ipdms.integration.msoffice.email.ReadEmailMSG" />

    <bean id="fileUploadFactory" class="com.sinfic.agora.io.file.upload.FileUploadFactory" />

</beans>
